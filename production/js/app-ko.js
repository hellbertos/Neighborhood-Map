window.onload=function(){var e="img/icon-eye.png",a="img/icon-dine.png",i="img/icon-surf.png",n="img/icon-drink.png",t=[{title:"Sutro Baths",latLng:{lat:37.780109,lng:-122.513965},icon:e,animation:null,fsid:"4a05e6dbf964a52098721fe3",zip:"94121",description:"The ruins of the former salt water fed bath house from the turn of the former century. Great visitors center and lots of hiking trails make it a must do!"},{title:"Wise Surfboards",latLng:{lat:37.772765,lng:-122.510714},icon:i,animation:null,fsid:"4a6d0b27f964a52065d21fe3",zip:"94121",description:"The oldest surviving surf shop in the city with views of the first peaks regularly surfed in San Francisco. They carry many of the top brands of boards and wetsuits."},{title:"The Beach Chalet",latLng:{lat:37.769517,lng:-122.510263},icon:a,animation:null,fsid:"43cc06a3f964a520c72d1fe3",zip:"94121",description:"Come for the great sunsets, stay for the tasty craft beers. Incredible views of the Pacific Ocean, a fantastic menu as well as well as beers brewed in-house. Great after a day at the beach."},{title:"Ocean Beach",latLng:{lat:37.765166,lng:-122.512592},icon:e,animation:null,fsid:"409ad180f964a520eef21ee3",zip:"94122",description:"Part of the Federal Parks Service, Ocean Beach is an awesome, natural experience of beach and ocean. Bonfires are allowed in the rings provided."},{title:"Aqua Surf Shop",latLng:{lat:37.760314,lng:-122.503595},icon:i,animation:null,fsid:"4ad0f5e0f964a52084db20e3",zip:"94122",description:"Locally owned and operated. Staffed with top-quality gear and experts to help you make the right purchase. Aqua also runs the only surfboard rental service in the area."},{title:"La Playa Taqueria",latLng:{lat:37.752834,lng:-122.50472},icon:a,animation:null,fsid:"4a664abcf964a52056c81fe3",zip:"94116",description:"Argueably the best breakfast burritos in the fogbelt. An extensive menu of traditional Mexican food from dinner plates to venerable burritos"},{title:"The Rip Tide Lounge",latLng:{lat:37.74158,lng:-122.505349},icon:n,animation:null,fsid:"4d3c6a863ec9a35dfd644881",zip:"94116",description:"The local place to grab a cold drink after a day Ocean Beach. Live music, great beers on tap, drink specials and a fire place to warm up next to!"},{title:"San Francisco Zoo",latLng:{lat:37.733201,lng:-122.502764},icon:e,animation:null,fsid:"49ca9423f964a520c0581fe3",zip:"94132",description:"The San Francisco Zoo is a world renowned exibit of live animals, conservation effort and research facility."}],o=function(e){for(var a=null,i=0;i<t.length;i++)t[i].title===e&&(a=t[i].fsid,console.info("The IDDD of "+t[i].title+" is "+t[i].fsid));{var n="https://api.foursquare.com/v2/venues/"+a+"?client_id=TPXYNVAKFZ3ZO55KQBFIUEBKQWHSGFL3EPG10VS0SAZZ2O51&client_secret=AY30L1ITLWN3A0MVJHZBICG1WTX1FFQFGB52EIEYIRDNBQEU&v=20130815&limit=3";$.ajax({url:n,data:{format:"json"},error:function(){var e="<div>Sorry, we do not have a picture for this location.</div>";$("#fsHere").append(e)},success:function(e){var a=e.response.venue.photos.groups[0].items.length,i=Math.floor(Math.random()*(a-1)),n=(e.response.venue.photos.groups[0].items[i].prefix+"175x175"+e.response.venue.photos.groups[0].items[i].suffix,'<div><img src="'+e.response.venue.photos.groups[0].items[i].prefix+"150x150"+e.response.venue.photos.groups[0].items[i].suffix+'"></div>');$("#fsHere").append(n)}})}},s=function(e){for(var a,i=0;i<t.length;i++)t[i].title===e&&(a=t[i].zip);var n="food",o={consumerKey:"JXePW9urpn9rtM0EbzaZmg",consumerSecret:"tAaubaecdRrxjVjlUcnVH1QQWdo",accessToken:"ehhl-T6l4g5QarL6BP6WxhN4PTu3mCqH",accessTokenSecret:"nRFrxQ5KM1i7LfUMFVC4VHq6JZc",serviceProvider:{signatureMethod:"HMAC-SHA1"}},s=n,r=a,l={consumerSecret:o.consumerSecret,tokenSecret:o.accessTokenSecret};parameters=[],parameters.push(["term",s]),parameters.push(["location",r]),parameters.push(["callback","cb"]),parameters.push(["oauth_consumer_key",o.consumerKey]),parameters.push(["oauth_token",o.accessToken]);var c={action:"http://api.yelp.com/v2/search",method:"GET",parameters:parameters};OAuth.setTimestampAndNonce(c),OAuth.SignatureMethod.sign(c,l);var p=OAuth.getParameterMap(c.parameters);$.ajax({url:c.action,data:p,dataType:"jsonp",jsonpCallback:"cb",cache:!0,success:function(e){console.log(e);var a=e.businesses.length,i=Math.floor(Math.random()*(a-1));if(e){var n="<h3>Dining Suggestion:</h3><div><strong>"+e.businesses[i].name+"</strong><ul><li>Yelp Rating: "+e.businesses[i].rating+"</li><li>Phone: "+e.businesses[i].display_phone+"</li><li>Address: "+e.businesses[i].location.address[0]+"</li><ul>";$("#yelpHere").append(n)}},error:function(){$("#yelpHere").append("Sorry, Yelp is not responding right now. Please try again later")}})},r=function(e,a,i,n,t){return new google.maps.Marker({position:e,map:t,icon:i,title:a,description:n})},l=function(){var e=this;e.placeList=ko.observableArray();var a=document.getElementById("map"),i={center:new google.maps.LatLng(37.760191,-122.502345),zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP};e.map=new google.maps.Map(a,i),e.infoWindow=new google.maps.InfoWindow({maxWidth:300});for(var n=0;n<t.length;n++){locale=t[n];var l=new r(locale.latLng,locale.title,locale.icon,locale.description,e.map);l.show=ko.observable(!0),e.placeList.push(l),function(a){google.maps.event.addListener(a,"click",function(){e.selectMarker(a)})}(l)}e.selectMarker=function(a){a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},2150);var i='<div id="infoWinInterior"><h1 class="infoWinTitle">'+a.title+'</h1><div id="fsContainer"><div id="fsHere"></div>'+a.description+'</div><div id="yelpHere"></div></div>';e.infoWindow.setContent(i),e.infoWindow.open(a.get("map"),a);o(a.title),s(a.title);e.map.panTo(a.getPosition()),console.info("getPosition is"+a.getPosition())},e.searchString=ko.observable(),e.searchIt=function(){var a=e.searchString().toLowerCase(),i=function(e){var i=e.title.toLowerCase();i.indexOf(a)<0?(e.setVisible(!1),e.show(!1)):(e.setVisible(!0),e.show(!0))};e.placeList().filter(i)},e.isActive=function(a,i){i===!0?(e.activeClass(!0),console.info("ACTIVE!! "+e.activeClass())):(e.activeClass(!1),console.info("NOT!! "+e.activeClass()))}};ko.applyBindings(new l)};